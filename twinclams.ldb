#base64 embeded mimikatz things
TwinWave.DROPADABASE.MIMIREFLECTIONS.B64.1.20191220;Engine:81-255,Target:0;0;41484276643256796332686c62477866636d566d6247566a64476c325a56397461573170613246306567
TwinWave.DROPADABASE.MIMIREFLECTIONS.B64.2.20191220;Engine:81-255,Target:0;0;41634739335a584a7a61475673624639795a575a735a574e3061585a6c5832317062576c725958523641
TwinWave.DROPADABASE.MIMIREFLECTIONS.B64.3.20191220;Engine:81-255,Target:0;0;42776233646c636e4e6f5a57787358334a6c5a6d786c59335270646d566662576c746157746864486f41
#Emotet doc strings
TwinWave.DROPADABASE.DOC.EMOTETSTYLINANDPROFILINB64.1.20191220;Engine:81-255,Target:0;((0|(1&(2|3))|(4&(5|6)))&7);0:417474726962757465205642::i;0:D0CF11E0A1B11AE1;5c564245372e444c4c::aw;5c564245362e444c4c::aw;0,1:3c3f786d6c;2f7061636b6167652f323030362f6d657461646174612f636f72652d70726f70657274696573::i;2f6f6666696365446f63756d656e742f323030362f657874656e6465642d70726f70657274696573::i;4139414351415a514275414859414f67423141484d415a51427941484141636742764147594161514273414755414b77416e414677414a77::aw
TwinWave.DROPADABASE.DOC.EMOTETSTYLINANDPROFILINB64.2;20191220Engine:81-255,Target:0;((0|(1&(2|3))|(4&(5|6)))&7);0:417474726962757465205642::i;0:D0CF11E0A1B11AE1;5c564245372e444c4c::aw;5c564245362e444c4c::aw;0,1:3c3f786d6c;2f7061636b6167652f323030362f6d657461646174612f636f72652d70726f70657274696573::i;2f6f6666696365446f63756d656e742f323030362f657874656e6465642d70726f70657274696573::i;415051416b414755416267423241446f416451427a4147554163674277414849416277426d41476b416241426c414373414a77426341436341::aw
TwinWave.DROPADABASE.DOC.EMOTETSTYLINANDPROFILINB64.3.20191220;Engine:81-255,Target:0;((0|(1&(2|3))|(4&(5|6)))&7);0:417474726962757465205642::i;0:D0CF11E0A1B11AE1;5c564245372e444c4c::aw;5c564245362e444c4c::aw;0,1:3c3f786d6c;2f7061636b6167652f323030362f6d657461646174612f636f72652d70726f70657274696573::i;2f6f6666696365446f63756d656e742f323030362f657874656e6465642d70726f70657274696573::i;5051416b414755416267423241446f416451427a4147554163674277414849416277426d41476b416241426c414373414a77426341436341::aw
TwinWave.DROPADABASE.DOC.EMOTETSTYLINANDPROFILINB64.4.20191220;Engine:81-255,Target:0;((0|(1&(2|3))|(4&(5|6)))&7);0:417474726962757465205642::i;0:D0CF11E0A1B11AE1;5c564245372e444c4c::aw;5c564245362e444c4c::aw;0,1:3c3f786d6c;2f7061636b6167652f323030362f6d657461646174612f636f72652d70726f70657274696573::i;2f6f6666696365446f63756d656e742f323030362f657874656e6465642d70726f70657274696573::i;414430414a41426c4147344164674136414855416377426c4148494163414279414738415a674270414777415a514172414363415841416e41::aw
#simple rule to detect sharphound component of bloodhound
Twinwave.SharpHoundCS.20191220;Engine:81-255,Target:1;(0&1);5368617270686F756E643200;496E766F6B65426C6F6F64486F756E6400
#Just a clam version of the mimikatz yara to detect in packed/archives etc.
TwinWave.MimiKatz.x64.20191220;Engine:81-255,Target:1;(0&1&2);33ff4?89374?8bf34585c?74;4c8bdf49{0-3}c1e30448{0-3}8bcb4c03;1/\x4c\x8b\xdf\x49.{0,3}\xc1\xe3\x04\x48.{0,3}\x8b\xcb\x4c\x03.{0,3}\xd8/s
#ursniff doc strings nocased msxsl tags
TwinWave.DROPADABASE.MSXSLTAGB64.1.20191220;Engine:81-255,Target:0;((0|(1&(2|3))|(4&(5|6)))&7&8);0:417474726962757465205642::i;0:D0CF11E0A1B11AE1;5c564245372e444c4c::aw;5c564245362e444c4c::aw;0,1:3c3f786d6c;2f7061636b6167652f323030362f6d657461646174612f636f72652d70726f70657274696573::i;2f6f6666696365446f63756d656e742f323030362f657874656e6465642d70726f70657274696573::i;3854;7/8T(?:VN(?:4(?:U(?:0w6(?:U[02]|c[02])|2w6(?:U[02]|c[02]))|c(?:0w6(?:U[02]|c[02])|2w6(?:U[02]|c[02])))|Y(?:U(?:0w6(?:U[02]|c[02])|2w6(?:U[02]|c[02]))|c(?:0w6(?:U[02]|c[02])|2w6(?:U[02]|c[02]))))|XN(?:4(?:U(?:0w6(?:U[02]|c[02])|2w6(?:U[02]|c[02]))|c(?:0w6(?:U[02]|c[02])|2w6(?:U[02]|c[02])))|Y(?:U(?:0w6(?:U[02]|c[02])|2w6(?:U[02]|c[02]))|c(?:0w6(?:U[02]|c[02])|2w6(?:U[02]|c[02])))))/
TwinWave.DROPADABASE.DOC.MSXSLTAGB64.2.20191220;Engine:81-255,Target:0;((0|(1&(2|3))|(4&(5|6)))&7&8);0:417474726962757465205642::i;0:D0CF11E0A1B11AE1;5c564245372e444c4c::aw;5c564245362e444c4c::aw;0,1:3c3f786d6c;2f7061636b6167652f323030362f6d657461646174612f636f72652d70726f70657274696573::i;2f6f6666696365446f63756d656e742f323030362f657874656e6465642d70726f70657274696573::i;784e;7/xN(?:U(?:1h(?:T(?:TDp(?:T[QY]|z[QY])|bDp(?:T[QY]|z[QY]))|z(?:TDp(?:T[QY]|z[QY])|bDp(?:T[QY]|z[QY])))|3h(?:T(?:TDp(?:T[QY]|z[QY])|bDp(?:T[QY]|z[QY]))|z(?:TDp(?:T[QY]|z[QY])|bDp(?:T[QY]|z[QY]))))|c(?:1h(?:T(?:TDp(?:T[QY]|z[QY])|bDp(?:T[QY]|z[QY]))|z(?:TDp(?:T[QY]|z[QY])|bDp(?:T[QY]|z[QY])))|3h(?:T(?:TDp(?:T[QY]|z[QY])|bDp(?:T[QY]|z[QY]))|z(?:TDp(?:T[QY]|z[QY])|bDp(?:T[QY]|z[QY])))))/
TwinWave.DROPADABASE.DOC.MSXSLTAGB64.3.20191220;Engine:81-255,Target:0;((0|(1&(2|3))|(4&(5|6)))&7&8);0:417474726962757465205642::i;0:D0CF11E0A1B11AE1;5c564245372e444c4c::aw;5c564245362e444c4c::aw;0,1:3c3f786d6c;2f7061636b6167652f323030362f6d657461646174612f636f72652d70726f70657274696573::i;2f6f6666696365446f63756d656e742f323030362f657874656e6465642d70726f70657274696573::i;3862;7/8b(?:VN(?:4(?:U(?:0w6(?:U[02]|c[02])|2w6(?:U[02]|c[02]))|c(?:0w6(?:U[02]|c[02])|2w6(?:U[02]|c[02])))|Y(?:U(?:0w6(?:U[02]|c[02])|2w6(?:U[02]|c[02]))|c(?:0w6(?:U[02]|c[02])|2w6(?:U[02]|c[02]))))|XN(?:4(?:U(?:0w6(?:U[02]|c[02])|2w6(?:U[02]|c[02]))|c(?:0w6(?:U[02]|c[02])|2w6(?:U[02]|c[02])))|Y(?:U(?:0w6(?:U[02]|c[02])|2w6(?:U[02]|c[02]))|c(?:0w6(?:U[02]|c[02])|2w6(?:U[02]|c[02])))))/
TwinWave.DROPADABASE.DOC.MSXSLTAGB64.4.20191220;Engine:81-255,Target:0;((0|(1&(2|3))|(4&(5|6)))&7&8);0:417474726962757465205642::i;0:D0CF11E0A1B11AE1;5c564245372e444c4c::aw;5c564245362e444c4c::aw;0,1:3c3f786d6c;2f7061636b6167652f323030362f6d657461646174612f636f72652d70726f70657274696573::i;2f6f6666696365446f63756d656e742f323030362f657874656e6465642d70726f70657274696573::i;5047;7/PG1(?:T(?:W(?:FN(?:MO(?:lN[Dj]|nN[Dj])|sO(?:lN[Dj]|nN[Dj]))|HN(?:MO(?:lN[Dj]|nN[Dj])|sO(?:lN[Dj]|nN[Dj])))|e(?:FN(?:MO(?:lN[Dj]|nN[Dj])|sO(?:lN[Dj]|nN[Dj]))|HN(?:MO(?:lN[Dj]|nN[Dj])|sO(?:lN[Dj]|nN[Dj]))))|z(?:W(?:FN(?:MO(?:lN[Dj]|nN[Dj])|sO(?:lN[Dj]|nN[Dj]))|HN(?:MO(?:lN[Dj]|nN[Dj])|sO(?:lN[Dj]|nN[Dj])))|e(?:FN(?:MO(?:lN[Dj]|nN[Dj])|sO(?:lN[Dj]|nN[Dj]))|HN(?:MO(?:lN[Dj]|nN[Dj])|sO(?:lN[Dj]|nN[Dj])))))/
TwinWave.DROPADABASE.DOC.MSXSLTAGB64.5.20191220;Engine:81-255,Target:0;((0|(1&(2|3))|(4&(5|6)))&7&8);0:417474726962757465205642::i;0:D0CF11E0A1B11AE1;5c564245372e444c4c::aw;5c564245362e444c4c::aw;0,1:3c3f786d6c;2f7061636b6167652f323030362f6d657461646174612f636f72652d70726f70657274696573::i;2f6f6666696365446f63756d656e742f323030362f657874656e6465642d70726f70657274696573::i;5045;7/PE1(?:T(?:W(?:FN(?:MO(?:lN[Dj]|nN[Dj])|sO(?:lN[Dj]|nN[Dj]))|HN(?:MO(?:lN[Dj]|nN[Dj])|sO(?:lN[Dj]|nN[Dj])))|e(?:FN(?:MO(?:lN[Dj]|nN[Dj])|sO(?:lN[Dj]|nN[Dj]))|HN(?:MO(?:lN[Dj]|nN[Dj])|sO(?:lN[Dj]|nN[Dj]))))|z(?:W(?:FN(?:MO(?:lN[Dj]|nN[Dj])|sO(?:lN[Dj]|nN[Dj]))|HN(?:MO(?:lN[Dj]|nN[Dj])|sO(?:lN[Dj]|nN[Dj])))|e(?:FN(?:MO(?:lN[Dj]|nN[Dj])|sO(?:lN[Dj]|nN[Dj]))|HN(?:MO(?:lN[Dj]|nN[Dj])|sO(?:lN[Dj]|nN[Dj])))))/
TwinWave.DROPADABASE.DOC.MSXSLTAGB64.6.20191220;Engine:81-255,Target:0;((0|(1&(2|3))|(4&(5|6)))&7&8);0:417474726962757465205642::i;0:D0CF11E0A1B11AE1;5c564245372e444c4c::aw;5c564245362e444c4c::aw;0,1:3c3f786d6c;2f7061636b6167652f323030362f6d657461646174612f636f72652d70726f70657274696573::i;2f6f6666696365446f63756d656e742f323030362f657874656e6465642d70726f70657274696573::i;7874;7/xt(?:U(?:1h(?:T(?:TDp(?:T[QY]|z[QY])|bDp(?:T[QY]|z[QY]))|z(?:TDp(?:T[QY]|z[QY])|bDp(?:T[QY]|z[QY])))|3h(?:T(?:TDp(?:T[QY]|z[QY])|bDp(?:T[QY]|z[QY]))|z(?:TDp(?:T[QY]|z[QY])|bDp(?:T[QY]|z[QY]))))|c(?:1h(?:T(?:TDp(?:T[QY]|z[QY])|bDp(?:T[QY]|z[QY]))|z(?:TDp(?:T[QY]|z[QY])|bDp(?:T[QY]|z[QY])))|3h(?:T(?:TDp(?:T[QY]|z[QY])|bDp(?:T[QY]|z[QY]))|z(?:TDp(?:T[QY]|z[QY])|bDp(?:T[QY]|z[QY])))))/
#Trickbot spliced run with empty value between
TwinWave.MacroDoc.TrickBotRunninOnEmpty.20191220;Engine:81-255,Target:2;(0&1&2&3&4);0:4174747269627574652056425f::i;6372656174656f626a656374::i;202620::i;202b20::i;0/[\s\r\n](?P<evar>[A-Za-z][A-Za-z0-9_]+)\s*=\s*Empty\b.*?[\x22\x27]r(?!un)(?=[^\r\n]*?[&+]\s*(?P=evar))(u|[\x22\x27]\s+[&+]\s+(?:(?P=evar)\s+[&+]\s+)?[\x22\x27]u)(n|[\x22\x27]\s+[&+]\s+(?:(?P=evar)\s+[&+]\s+)?[\x22\x27]n)/si
TwinWave.MacroDoc.CROSPLICEMINESOFKESSEL.20191220;Engine:81-255,Target:2;(0&1&2);0:4174747269627574652056425f::i;6372656174656f626a656374::i;1/CreateObject\x28+(?:(?!\x22\x22[^\s])[^\r\n\x29\x28]*?(?:\b[A-Za-z][A-Za-z0-9_]+|\x22[^\x22]*\x22)\s[&+]\s){3}/i
#multiline string builder f4eabb301008404f8d27ae0ada1bbcb5f807a8847f812204bb083919da9b505f
TwinWave.EvilDoc.MacroStringTheory.M1.20191223;Engine:81-255,Target:2;(0&((1|2|3|4|5|6|7|8|9|10)>20)&(11|12)&(13|14)&15);0:4174747269627574652056425f::i;3029::i;3129::i;3229::i;3329::i;3429::i;3529::i;3629::i;3729::i;3829::i;3929::i;2e72756e::i;7368656c6c::i;507269766174652046756e6374696f6e::i;5072697661746520537562::i;(13|14)/Private (?:Function|Sub)\s+[a-z]{4,6}\(\s*\)\s*\r?\n\s*[a-z]{4,6}\s*=\s*0\s*\r?\n(?P<var>[a-z]{4,6})\s*=\s*\x22\x22\s*\r?\n\s*(?P=var)\s*=\s*[a-z]{4,6}\(\s*(?P=var)\s*,\s*\d+\)\r?\n\s*(?P=var)\s*=\s*[a-z]{4,6}\(\s*(?P=var)\s*,\s*\d+\)\r?\n\s*(?P=var)\s*=\s*[a-z]{4,6}\(\s*(?P=var)\s*,\s*\d+\)\r?\n\s*(?P=var)\s*=\s*[a-z]{4,6}\(\s*(?P=var)\s*,\s*\d+\)\r?\n\s*(?P=var)\s*=\s*[a-z]{4,6}\(\s*(?P=var)\s*,\s*\d+\)/
#Emotet things
TwinWave.EvilDoc.DOCXRSTRGOOD.EmotetB64.B64.1.20200115;Engine:81-255,Target:0;((0|(1&(2|3))|(4&(5|6)))&7);0:417474726962757465205642::i;0:D0CF11E0A1B11AE1;5c564245372e444c4c::aw;5c564245362e444c4c::aw;0,1:3c3f786d6c;2f7061636b6167652f323030362f6d657461646174612f636f72652d70726f70657274696573::i;2f6f6666696365446f63756d656e742f323030362f657874656e6465642d70726f70657274696573::i;414349414b41416e41436f414a774170414473414a41::aw
TwinWave.EvilDoc.DOCXRSTRGOOD.EmotetB64.B64.2.20200115;Engine:81-255,Target:0;((0|(1&(2|3))|(4&(5|6)))&7);0:417474726962757465205642::i;0:D0CF11E0A1B11AE1;5c564245372e444c4c::aw;5c564245362e444c4c::aw;0,1:3c3f786d6c;2f7061636b6167652f323030362f6d657461646174612f636f72652d70726f70657274696573::i;2f6f6666696365446f63756d656e742f323030362f657874656e6465642d70726f70657274696573::i;414967416f414363414b67416e41436b414f77416b41::aw
TwinWave.EvilDoc.DOCXRSTRGOOD.EmotetB64.B64.3.20200115;Engine:81-255,Target:0;((0|(1&(2|3))|(4&(5|6)))&7);0:417474726962757465205642::i;0:D0CF11E0A1B11AE1;5c564245372e444c4c::aw;5c564245362e444c4c::aw;0,1:3c3f786d6c;2f7061636b6167652f323030362f6d657461646174612f636f72652d70726f70657274696573::i;2f6f6666696365446f63756d656e742f323030362f657874656e6465642d70726f70657274696573::i;4969676e4b6963704f79::aw
TwinWave.EvilDoc.DOCXRSTRGOOD.EmotetB64.B64.4.20200115;Engine:81-255,Target:0;((0|(1&(2|3))|(4&(5|6)))&7);0:417474726962757465205642::i;0:D0CF11E0A1B11AE1;5c564245372e444c4c::aw;5c564245362e444c4c::aw;0,1:3c3f786d6c;2f7061636b6167652f323030362f6d657461646174612f636f72652d70726f70657274696573::i;2f6f6666696365446f63756d656e742f323030362f657874656e6465642d70726f70657274696573::i;4169414367414a774171414363414b51413741435141::aw
TwinWave.EvilDoc.DOCXRSTRGOOD.EmotetB64.B64.5.20200115;Engine:81-255,Target:0;((0|(1&(2|3))|(4&(5|6)))&7);0:417474726962757465205642::i;0:D0CF11E0A1B11AE1;5c564245372e444c4c::aw;5c564245362e444c4c::aw;0,1:3c3f786d6c;2f7061636b6167652f323030362f6d657461646174612f636f72652d70726f70657274696573::i;2f6f6666696365446f63756d656e742f323030362f657874656e6465642d70726f70657274696573::i;694b4363714a796b374a::aw
TwinWave.EvilDoc.DOCXRSTRGOOD.EmotetB64.B64.6.20200115;Engine:81-255,Target:0;((0|(1&(2|3))|(4&(5|6)))&7);0:417474726962757465205642::i;0:D0CF11E0A1B11AE1;5c564245372e444c4c::aw;5c564245362e444c4c::aw;0,1:3c3f786d6c;2f7061636b6167652f323030362f6d657461646174612f636f72652d70726f70657274696573::i;2f6f6666696365446f63756d656e742f323030362f657874656e6465642d70726f70657274696573::i;496f4a796f6e4b54736b::aw
TwinWave.EvilDoc.EmotetMacro.20200115;Engine:81-255,Target:2;(0&1&2&3&4);0:417474726962757465205642::i;536574{0-255}4765744f626a656374::i;2e437265617465::i;636872::i;(1)/Set\s*(?P<var1>[A-Za-z][A-Za-z0-9_-]*)\s*=\s*GetObject\s*\$?\((?P<var2>[A-Za-z][A-Za-z0-9_-]*)\)(?=.*?(?P=var1)\.create).*?(?P=var2)\s*[&+]\s*Chr/si
#Emotet Form storage
TwinWave.EvilDoc.Emotet.BADFORM.20200115;Engine:81-255,Target:0;((0|(1&(2|3)))&4&5&6);0:417474726962757465205642::i;0:D0CF11E0A1B11AE1;5c564245372e444c4c::aw;5c564245362e444c4c::aw;433A5C55736572735C41444D494E497E315C417070446174615C4C6F63616C5C54656D705C;0E00{12}202020202020*4a4142;5/\x0E\x00[A-Za-z]{12}\x20{5,}JAB/
